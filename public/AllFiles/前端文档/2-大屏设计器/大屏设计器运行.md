# 一、大屏项目总览

* 大屏设计器工程框架：http://git.qpaas.com/lowcode/big-data-designer-frame

    包含多个子工程，核心：big-data-designer、qpaas-big-data-components

    * 大屏设计器：http://git.qpaas.com/lowcode/big-data-designer
    * 大屏设计器通用组件：http://git.qpaas.com/lowcode/qpaas-big-data-components

* [大屏2期自测问题列表](https://blogqpaas.yuque.com/zt5qau/agvy4h/saicxo9wy7v7qpo7)

* 物料市场：http://10.0.16.106:3000/component/docs/@qpaas/data-vision/QpaasNavigationBar
    * 大屏设计器通用组件官方文档：http://10.0.16.106:3000/component/docs/@qpaas/data-vision/QpaasNavigationBar



# 二、单独运行『大屏组件库文档』

* 物料市场：http://10.0.16.106:3000/component/docs/@qpaas/data-vision/QpaasNavigationBar

大屏设计器通用组件仓库地址：http://git.qpaas.com/lowcode/qpaas-big-data-components

```sh
# 拉取仓库
$ git clone http://git.qpaas.com/lowcode/qpaas-big-data-components

# 更新运行
$ pnpm install 
$ pnpm dev

# or
$ cd example
$ pnpm dev

# 2024.12.13 运行失败，使用npm运行成功，原因未知！！！
$ npm run dev
# or
$ cd example 
$ npm run dev
```

直接打开，自动跳转到页面

http://localhost:5173/  --->  http://localhost:5173/QpaasNavigationBar

![](/AllFiles/前端文档/2-大屏设计器/images/001.png)



# A. 环境介绍⭐️

```sh
# integration持续集成环境：
> https://cidemo.qpaas.com
> 账号：qat_admin / qat83752661

# or 大风车环境
> http://www172168000036.pinwheel.qycloud.com.cn:39000/
> 账号：apitest / 11111111
```

* cidemo 环境有点老，不建议

* www172168000036环境「域名」访问有问题，使用 **IP地址**

    * IP地址：http://172.168.0.36:39000/
        * 注意1：登录成功没有反应，再次打开 http://172.168.0.36:39000/
        * 注意2：前台有时候有问题打不开，需要张林松帮忙处理。
    * 后台地址：
        * http://172.168.0.36:39000/homepage
    * 大屏 - 大屏管理：
        * http://172.168.0.36:39000/space-APICeShiQiYe/datavision/manage
        * http://172.168.0.36:39000/space-APICeShiQiYe/datavision/manage/visionManagement
        * http://172.168.0.36:39000/space-APICeShiQiYe/datavision/manage/visionManagement?hideSide=1

    * ###### 大屏 - 模板中心：

        * http://172.168.0.36:39000/space-APICeShiQiYe/datavision/manage/templateCenter



# 三、运行『大屏管理页面』 - 在官网网页中调试

## 1. 查看线上大屏管理页面

```sh
# integration持续集成环境：
> https://cidemo.qpaas.com
> 账号：qat_admin / qat83752661

# or 大风车环境
> http://www172168000036.pinwheel.qycloud.com.cn:39000/
> 账号：apitest / 11111111
```

* Paas中心  ->  应用平台  ->  应用管理  ->  大屏设计器  ->  开发

![](/AllFiles/前端文档/2-大屏设计器/images/002.png)

![](/AllFiles/前端文档/2-大屏设计器/images/003.png)

* 网页地址：https://cidemo.qpaas.com/space-yewugongnengceshiqiy/datavision/manage/visionManagement?hideSide=1



## 2. hosts文件 新增代理

```sh
# 大屏管理
127.0.0.1 dev110.cidemo.qpaas.com
127.0.0.1 dev110.www172168000036.pinwheel.qycloud.com.cn
```



## 3. 运行『启业云前端主工程』- qycloud-main

* qycloud-main仓库：http://git.qpaas.com/micro-apps/qycloud-main

第一步：设置环境

```sh
# .env.development   -->   PROXY_HOST

# cidemo地址
PROXY_HOST = https://cidemo.qpaas.com/

# 大风车地址
PROXY_HOST = http://www172168000036.pinwheel.qycloud.com.cn:39000/
```

第二步：node 12

```sh
$ nvm use 12
```

第三步：更新仓库

```sh
$ npm install
```

第四步：运行

* 选择『新模式』，以36环境为例

```sh
$ npm run serve

> qycloud-main@0.1.0 serve /Users/qiyeyun/Work/qycloud-main
> node ./tools/copyStatic.js && node ./devServer.js

copy auom-ui static files
? 请选择本地代理方式 新模式(将提供预制环境选择或者自定义输入环境地址,访问时通过localhost访问即可)
? 请选择env环境配置: 大风车
? 请输入大风车环境地址后四位: 0036
? 请输入登录账号 apitest
? 请输入登录密码 111111
? 是否为子应用生成环境本路径环境变量 是
http://www172168000036.pinwheel.qpaas.com:39000 PROXY_SERVER
```

* 选择『原有模式』

```sh
$ npm run serve

> qycloud-main@0.1.0 serve /Users/qiyeyun/Work/qycloud-main
> node ./tools/copyStatic.js && node ./devServer.js

copy auom-ui static files
? 请选择本地代理方式 
  新模式(将提供预制环境选择或者自定义输入环境地址,访问时通过localhost访问即可) 
  直接启动, 我已输入过账号密码了!(只适用于新模式) 
❯ 原有模式 
```

第五步：替换代理地址，证明能打开

```sh
# 运行地址
https://localhost:39000/

# 替换代理地址 + 大屏的地址
https://dev110.cidemo.qpaas.com:39000/space-yewugongnengceshiqiy/datavision/manage/visionManagement?hideSide=1

# 大风车地址
http://dev110.www172168000036.pinwheel.qycloud.com.cn:39000/space-APICeShiQiYe/datavision/manage/componentCenter?hideSide=1
```

备注：页面提示不安全，键盘输入：this is unsafe

![](/AllFiles/前端文档/2-大屏设计器/images/004.png)



## 4. 运行『大屏管理页面』

* qpaas-app-design仓库：http://git.qpaas.com/micro-apps/qpaas-app-design
* 分支
    * 一期分支：feat/deploy-with-sub-route
    * 二期分支：feature/LX_inte_manager




第一步：**查看主工程的地址，http or https**

```sh
qpaas-app-design项目  --->   vue.config.js   --->   https: false or true
```

第二步：node 12

```sh
$ nvm use 12
```

第三步：更新仓库

```sh
$ npm install
```

第四步：运行

```sh
$ npm run serve

> qpaas-app-design@0.1.0 serve /Users/qiyeyun/Work/qpaas-app-design
> vue-cli-service serve

 INFO  Starting development server...
 WARN  A new version of sass-loader is available. Please upgrade for best experience.
10% building 2/2 modules 0 active(node:99234) DeprecationWarning: Tapable.plugin is deprecated. Use new API on `.hooks` instead
stdout: 已自动同步微前端配置至主应用qycloud-main
已自动同步路由至主应用qycloud-main

stderr: 
98% after emitting CopyPlugin
```

第四步：替换代理，即可打开本地代码的页面，进行调试。

```sh
# 替换代理地址 + 大屏的地址
https://dev110.cidemo.qpaas.com:39000/space-yewugongnengceshiqiy/datavision/manage/visionManagement?hideSide=1

# 大风车
http://dev110.www172168000036.pinwheel.qycloud.com.cn:39000/space-APICeShiQiYe/datavision/manage/componentCenter?hideSide=1
```

打开发现，同样的链接，页面已经显示的是我们本地的代码了，多了模板中心和组件中心。

![](/AllFiles/前端文档/2-大屏设计器/images/005.png)



# 四、运行『大屏设计器』

## 1. 之前的

```sh
# 大屏设计器主工程
$ git clone http://git.qpaas.com/lowcode/big-data-designer-frame.git
```

核心子模块

* big-data-designer
* qpaas-big-data-components  （上面单独运行的大屏组件文档的项目）

```sh
# 拉取子模块代码
$ git submodule init
$ git submodule update
```

登录

```sh
$ npm login --registry https://open-npm.qpaas.com/
# or
$ npm login --registry=https://open-npm.qpaas.com/
Username: 15151963160
Password: linxiang123456
Email: (this IS public) 597207909@qq.com
Logged in as 15151963160 on https://open-npm.qpaas.com/.
```

前往子模块拉取代码

```sh
# 前往两个核心的子仓库，分别拉取
$ cd packages/big-data-designer
$ cd packages/qpaas-big-data-components

# 当作普通的仓库操作即可
$ git pull
$ git reset --hard
$ git checkout integration
```

在根目录下安装包

```sh
$ pnpm bootstrap
```

进入 cd packages/big-data-designer 运行

```sh
$ cd packages/big-data-designer
$ npm run serve

> @qpaas/big-data-designer@0.1.2 serve
> vite

The CJS build of Vite's Node API is deprecated. See https://vitejs.dev/guide/troubleshooting.html#vite-cjs-node-api-deprecated for more details.

  VITE v5.0.10  ready in 985 ms
  ➜  Local:   http://localhost:5173/                                                                                                                                                                                    
  ➜  Network: use --host to expose                                                                                                                                                                                     
  ➜  press h + enter to show help    
```

打开  `http://localhost:5173/`   --->   `http://localhost:5173/datavision/edit`

若打不开设计器的页面，则需要配置 Cookie 和 环境代理

```sh
$ cd packages/big-data-designer

# 打开.env文件，设置 PROXY_SERVER 和 PROXY_COOKIE
# PROXY_COOKIE 从 www172168000036 大风车请求中获取
PROXY_COOKIE=PHPSESSID=fd4dc95d-60c5-41ea-b96c-c950a25725c4; access_token=fd4dc95d-60c5-41ea-b96c-c950a25725c4; CURRENT_ENT=APICeShiQiYe; ent_user=APICeShiQiYe_6_ApiTest; locale=zh-CN; client_string=n6ij82ApiTest1708322695000
PROXY_SERVER=http://www172168000036.pinwheel.qpaas.com:39000/
```

![](/AllFiles/前端文档/2-大屏设计器/images/006.png)



代理配置完成，打开036大风车中的大屏设计器

* 036环境的 - 大屏设计器管理页面
    * http://www172168000036.pinwheel.qpaas.com:39000/space-APICeShiQiYe/datavision/manage?hideSide=1
    * ![](/AllFiles/前端文档/2-大屏设计器/images/007.png)
* 036环境的 - 某个大屏
    * http://www172168000036.pinwheel.qpaas.com:39000/datavision/APICeShiQiYe/edit/507675097767788544/0.0.1
    * ![](/AllFiles/前端文档/2-大屏设计器/images/008.png)



拼接地址：http://localhost:5173/  +  datavision/APICeShiQiYe/edit/507675097767788544/0.0.1

http://localhost:5173/datavision/APICeShiQiYe/edit/507675097767788544/0.0.1



## 2. 新版

前面步骤是一致的，运行

a. 拉取模块最新代码

* big-data-designer：feature/dev
* qpaas-big-data-components：feature/dev

b. 先移除所有`node_modules` ，包括根目录与子模块目录下的`node_modules`

最后在最外层目录下，运行

```sh
# 根目录下
$ pnpm bootstrap
```

b. 前往 `big-data-designer` 目录下运行

```sh
$ pnpm run serve
```











# 五、运行『组件中心、微组件』- 在官网中运行



## 1. 运行『启业云前端主工程』- qycloud-main

同上



## 2. 运行『组件中心、微组件』

* 组件中心、微组件仓库：http://git.qpaas.com/micro-apps/qpaas-ope-manage.git

* 分支
  * 23.12切的二级路由分支（**企框分支，不能改**）：feat/deploy-with-sub-route
  * 大屏二期分支：feature/componentcenter-optimize



第一步：**查看主工程的地址，http or https**

```sh
qpaas-ope-manage项目  --->   vue.config.js   --->   https: false or true
```

第二步：node 12

```sh
$ nvm use 12
```

第三步：不需要改代理环境

第四步：python版本更换2.7

```sh
$ conda deactivate
$ conda activate python27
```

第五步：更新仓库

```sh
$ npm install
```

第六步：运行

```sh
$ npm run serve
```

第七步：打开浏览器

```
http://dev110.www172168000036.pinwheel.qycloud.com.cn:39000/space-APICeShiQiYe/componentcenter
```





# 六、二级路由

## 1. 二级路由相关文档

* 平台支持二级路由开发说明  https://blogqpaas.yuque.com/kidsv4/vn8ois/wm0d4ngyv1gtnggv#FHhcx

* 平台支持二级路由部署  https://blogqpaas.yuque.com/kidsv4/msy6kb/lyvxgrdmv2xl01a1



## 2. 配置hosts

```
# 随便配置到本地代理即可
127.0.0.1 dev110.test.qpaas.com
```



## 3. 先运行『启业云前端主工程』- qycloud-main

* qycloud-main仓库：http://git.qpaas.com/micro-apps/qycloud-main

第一步：切换到二级路由分支

```sh
$ gco feat/deploy-with-sub-route
```

第二步：设置环境

| 测试主入口 | http://10.0.16.49:5173/ | 账号：02210221 / 02210221 |
| ---------- | ----------------------- | ------------------------- |

```sh
# .env.development   -->   PROXY_HOST

# 二级路由测试地址
PROXY_HOST = http://10.0.16.49:5173/

# 平台根路径
DEPLOY_BASE_ROUTE=/sczyaqglxxhxtgz/
```

![](/AllFiles/前端文档/2-大屏设计器/images/009.png)

第三步：node 12

```sh
$ nvm use 12
```

第四步：更新仓库

```sh
$ npm install
```

第五步：运行，选择『新模式』

```sh
$ npm run serve

> qycloud-main@0.1.0 serve /Users/qiyeyun/Work/qycloud-main
> node ./tools/copyStatic.js && node ./devServer.js

copy auom-ui static files
? 请选择本地代理方式 新模式(将提供预制环境选择或者自定义输入环境地址,访问时通过localhost访问即可)
? 请选择env环境配置: 我不, 我就要自己输
? 请输入你想代理的环境地址: http://10.0.16.49:5173/sczyaqglxxhxtgz
? 请输入登录账号 02210221
? 请输入登录密码 02210221
? 是否为子应用生成环境本路径环境变量 是
http://10.0.16.49:5173/sczyaqglxxhxtgz PROXY_SERVER
```

![](/AllFiles/前端文档/2-大屏设计器/images/010.png)



## 4. 运行『大屏管理页面』

* qpaas-app-design仓库：http://git.qpaas.com/micro-apps/qpaas-app-design

一期分支：feat/deploy-with-sub-route

二期分支：feature/LX_inte_manager

其他同上



## 5. 打开页面

```sh
# 本地代理地址
http://localhost:39000/sczyaqglxxhxtgz/space-sczyaqglxxhxtgz/user/workbench
http://dev110.cidemo.qpaas.com:39000/sczyaqglxxhxtgz/space-sczyaqglxxhxtgz/user/workbench

# 浏览器打开大屏管理页面
http://dev110.cidemo.qpaas.com:39000/sczyaqglxxhxtgz/space-sczyaqglxxhxtgz/datavision/manage/visionManagement?hideSide=1

http://dev110.cidemo.qpaas.com:39000/sczyaqglxxhxtgz/space-sczyaqglxxhxtgz/componentcenter
```





# 七、`qpaas-ue5-map-components`

* `qpaas-ue5-map-components`
    * 三维地图及UE5组件
    * http://git.qpaas.com/lowcode/qpaas-ue5-map-components



## 1. 运行

```sh
# 1. Node版本 > 18.18

# 2. 安装
$ pnpm i

# 3. 运行
$ pnpm run serve
```

































